(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{72:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var c,s,r,a,i=n(2),j=n.n(i),d=n(63),l=n.n(d),o=(n(72),n(22)),b=n(10),h=n(9),O=n(4),u=function(){return Object(O.jsxs)("nav",{className:"navbar",children:[Object(O.jsx)("h1",{children:"BB's Website"}),Object(O.jsxs)("div",{className:"links",children:[Object(O.jsx)(o.b,{to:"/",children:"Home"}),Object(O.jsx)(o.b,{to:"/create",children:"New Post"})]})]})},x=n(27),p=Object(h.gql)(c||(c=Object(x.a)(["\n{\n  posts(order_by: {id: desc}) {\n    id\n    body\n    title\n  }\n}\n"]))),v=function(){var e=Object(h.useQuery)(p),t=e.loading,n=e.error,c=e.data;return t?Object(O.jsx)("h5",{children:"Loading"}):n?Object(O.jsxs)("div",{children:[Object(O.jsx)("h3",{children:"The following error has occured:"}),Object(O.jsx)("p",{children:null===n||void 0===n?void 0:n.message})]}):c.posts.map((function(e){return Object(O.jsx)("div",{className:"post-preview",children:Object(O.jsx)(o.b,{to:"/posts/".concat(e.id),children:Object(O.jsx)("h2",{children:e.title})})})}))},m=n(31),w=new h.ApolloClient({cache:new h.InMemoryCache,link:new h.HttpLink({uri:"https://touched-serval-58.hasura.app/v1/graphql",headers:{"x-hasura-admin-secret":"IwLaLm1BACwrg8vx1oN8Z6H6UJSVyUvwzVsyYLjk5EjdQSwI3KlztYLI3mJOOQKh"}})}),g=Object(h.gql)(s||(s=Object(x.a)(["\n    mutation posts($body: String!, $title: String!) {\n    insert_posts(objects: {body: $body, title: $title}) {\n      affected_rows\n    }\n}"]))),y=function(){var e=Object(i.useState)(""),t=Object(m.a)(e,2),n=t[0],c=t[1],s=Object(i.useState)(""),r=Object(m.a)(s,2),a=r[0],j=r[1],d=Object(i.useState)(!1),l=Object(m.a)(d,2),o=l[0],h=l[1],u=Object(b.f)();return Object(O.jsxs)("div",{className:"create",children:[Object(O.jsx)("h2",{children:"Add a New Post"}),Object(O.jsxs)("form",{onSubmit:function(e){h(!0),w.mutate({mutation:g,variables:{title:n,body:a}}),h(!1),u.push("/")},children:[Object(O.jsx)("label",{children:"Post Title:"}),Object(O.jsx)("input",{type:"text",required:!0,value:n,onChange:function(e){c(e.target.value)}}),Object(O.jsx)("label",{children:"Post Body:"}),Object(O.jsx)("textarea",{required:!0,value:a,onChange:function(e){j(e.target.value)}}),!o&&Object(O.jsx)("button",{children:"Add Post"}),o&&Object(O.jsx)("button",{disabled:!0,children:"Adding ..."})]})]})},f=Object(h.gql)(r||(r=Object(x.a)(["\n    query MyQuery($id: Int!) {\n        posts(where: {id: {_eq: $id}}) {\n            body\n            title\n        }\n    }\n"]))),L=Object(h.gql)(a||(a=Object(x.a)(["\n    mutation ($_eq: Int!) {\n        delete_posts(where: {id: {_eq: $_eq}}) {\n            affected_rows\n        }\n    }\n"]))),q=new h.ApolloClient({cache:new h.InMemoryCache,link:new h.HttpLink({uri:"https://touched-serval-58.hasura.app/v1/graphql",headers:{"x-hasura-admin-secret":"IwLaLm1BACwrg8vx1oN8Z6H6UJSVyUvwzVsyYLjk5EjdQSwI3KlztYLI3mJOOQKh"}})}),I=function(){var e=Object(b.g)().idx,t=Object(b.f)(),n=+e,c=Object(h.useQuery)(f,{variables:{id:n}}),s=c.loading,r=c.error,a=c.data,i=function(){q.mutate({mutation:L,variables:{_eq:n}}),t.push("/")};return s?Object(O.jsx)("h5",{children:"Loading"}):r?Object(O.jsxs)("div",{className:"post-details",children:[Object(O.jsx)("h2",{children:"The following error occured:"}),Object(O.jsx)("p",{children:null===r||void 0===r?void 0:r.message})]}):a.posts.map((function(e){return Object(O.jsxs)("div",{className:"post-details",children:[Object(O.jsx)("p",{children:e.body}),Object(O.jsx)("br",{}),Object(O.jsx)("button",{onClick:i,children:"delete post"})]})}))},k=function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Sorry"}),Object(O.jsx)("p",{children:"Page cannot be found"}),Object(O.jsx)(o.b,{to:"/",children:"Back to the homepage"})]})},S=new h.ApolloClient({cache:new h.InMemoryCache,link:new h.HttpLink({uri:"https://touched-serval-58.hasura.app/v1/graphql",headers:{"x-hasura-admin-secret":"IwLaLm1BACwrg8vx1oN8Z6H6UJSVyUvwzVsyYLjk5EjdQSwI3KlztYLI3mJOOQKh"}})});var C=function(){return Object(O.jsx)(h.ApolloProvider,{client:S,children:Object(O.jsx)(o.a,{children:Object(O.jsxs)("div",{children:[Object(O.jsx)(u,{}),Object(O.jsx)("div",{className:"content",children:Object(O.jsxs)(b.c,{children:[Object(O.jsx)(b.a,{exact:!0,path:"/",children:Object(O.jsx)(v,{})}),Object(O.jsx)(b.a,{path:"/create",children:Object(O.jsx)(y,{})}),Object(O.jsx)(b.a,{path:"/posts/:idx",children:Object(O.jsx)(I,{})}),Object(O.jsx)(b.a,{path:"*",children:Object(O.jsx)(k,{})})]})})]})})})};l.a.render(Object(O.jsx)(j.a.StrictMode,{children:Object(O.jsx)(C,{})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.7cf9e41c.chunk.js.map